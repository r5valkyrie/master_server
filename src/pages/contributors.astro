---
import Main from '../layouts/Main.astro';

const GITHUB_REPO = 'r5valkyrie/docs';
const GITHUB_BRANCH = 'main';
const GITHUB_CONTRIBUTORS_PATH = 'contributors';

async function fetchFile(fileName: string) {
    const url = `https://raw.githubusercontent.com/${GITHUB_REPO}/${GITHUB_BRANCH}/${GITHUB_CONTRIBUTORS_PATH}/${fileName}?t=${Date.now()}`;
    const response = await fetch(url);
    if (!response.ok) {
        throw new Error(`Failed to fetch ${fileName}`);
    }
    return response.json();
}

const [valkyrieContributors, r5reloadedContributors] = await Promise.all([
    fetchFile('contributors.json'),
    fetchFile('r5reloaded_contributors.json')
]);
---

<Main>
    <div class="contributors-container">
        <h1>Valkyrie Contributors</h1>
        <div class="contributors-grid">
            {valkyrieContributors.map((contributor: any) => (
                <div class="contributor-card fade-in-on-scroll">
                    <img src={contributor.avatar} alt={contributor.name} class="contributor-avatar" />
                    <h2>{contributor.name}</h2>
                    <p>{contributor.description}</p>
                </div>
            ))}
        </div>

        <h1 class="section-title">Original R5Reloaded Contributors</h1>
        <div class="contributors-grid">
            {r5reloadedContributors.map((contributor: any) => (
                <div class="contributor-card fade-in-on-scroll">
                    <img src={contributor.avatar} alt={contributor.name} class="contributor-avatar" />
                    <h2>{contributor.name}</h2>
                    <p>{contributor.description}</p>
                </div>
            ))}
        </div>
    </div>
</Main>

<style>
    .contributors-container {
        padding: 2rem;
        max-width: 1200px;
        margin: 0 auto;
        color: var(--text-color);
        width: 100%;
    }

    h1 {
        font-size: 2.5rem;
        text-align: center;
        margin-bottom: 2rem;
        color: white;
    }
    
    .section-title {
        margin-top: 4rem;
    }

    .contributors-grid {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
        gap: 2rem;
    }

    .contributor-card {
        background-color: rgba(25, 28, 34, 0.7);
        border: 1px solid rgba(255, 255, 255, 0.1);
        backdrop-filter: blur(10px);
        -webkit-backdrop-filter: blur(10px);
        border-radius: 8px;
        padding: 2rem;
        text-align: center;
        box-shadow: 0 2px 8px rgba(0,0,0,0.1);
    }

    .contributor-avatar {
        width: 100px;
        height: 100px;
        border-radius: 50%;
        margin-bottom: 1rem;
        border: 3px solid var(--primary-color);
    }

    .contributor-card h2 {
        font-size: 1.5rem;
        margin-bottom: 0.5rem;
        color: white;
    }

    .contributor-card p {
        line-height: 1.6;
    }
</style>
