---
import Main from "../layouts/Main.astro";

const GITHUB_REPO = "r5valkyrie/docs";
const GITHUB_BRANCH = "main";
const GITHUB_CONTRIBUTORS_PATH = "contributors";

// Fix GitHub blob URLs to raw URLs to avoid CORS issues
function normalizeGitHubUrl(url: string): string {
	if (!url) return url;
	
	// Convert github.com/user/repo/blob/branch/path?raw=true to raw.githubusercontent.com/user/repo/branch/path
	const blobMatch = url.match(/^https?:\/\/github\.com\/([^\/]+)\/([^\/]+)\/blob\/([^\/]+)\/(.+?)(\?raw=true)?$/);
	if (blobMatch) {
		const [, user, repo, branch, path] = blobMatch;
		return `https://raw.githubusercontent.com/${user}/${repo}/${branch}/${path}`;
	}
	
	return url;
}

async function fetchContributors(fileName: string) {
	const url = `https://raw.githubusercontent.com/${GITHUB_REPO}/${GITHUB_BRANCH}/${GITHUB_CONTRIBUTORS_PATH}/${fileName}`;
	try {
		const response = await fetch(url);
		if (!response.ok) {
			console.error(
				`Failed to fetch ${fileName}. Status: ${response.status}`,
			);
			return [];
		}
		const contributors = await response.json();
		// Normalize avatar URLs
		return contributors.map((c: any) => ({
			...c,
			avatar: normalizeGitHubUrl(c.avatar)
		}));
	} catch (error) {
		console.error(`Error fetching ${fileName}:`, error);
		return [];
	}
}

async function fetchSupporters() {
	const url = `https://raw.githubusercontent.com/${GITHUB_REPO}/${GITHUB_BRANCH}/${GITHUB_CONTRIBUTORS_PATH}/supporters.json`;
	try {
		const response = await fetch(url);
		if (!response.ok) {
			console.error(`Failed to fetch supporters.json. Status: ${response.status}`);
			return [];
		}
		const supporters = await response.json();
		// Normalize avatar URLs
		return supporters.map((s: any) => ({
			...s,
			avatar: normalizeGitHubUrl(s.avatar)
		}));
	} catch (error) {
		console.error(`Error fetching supporters.json:`, error);
		return [];
	}
}

const [valkyrieContributors, r5reloadedContributors, supporters] = await Promise.all([
	fetchContributors("contributors.json"),
	fetchContributors("r5reloaded_contributors.json"),
	fetchSupporters(),
]);

---

<Main title="Contributors" fullWidth={true}>
	<div class="contributors-wrapper fade-in">
		<aside class="contributors-sidebar">
			<div class="sidebar-header">
				<h3>Contributors</h3>
			</div>
			<div class="sidebar-content custom-scrollbar">
				<div class="sidebar-stats">
					<div class="stat-row">
						<span class="stat-number">{supporters.length + valkyrieContributors.length + r5reloadedContributors.length}</span>
						<span class="stat-label">Total Contributors</span>
					</div>
					<div class="stat-divider"></div>
					<div class="stat-breakdown">
						<div class="stat-mini">
							<span class="stat-mini-num">{supporters.length}</span>
							<span class="stat-mini-label">Supporters</span>
						</div>
						<div class="stat-mini">
							<span class="stat-mini-num">{valkyrieContributors.length}</span>
							<span class="stat-mini-label">Valkyrie</span>
						</div>
						<div class="stat-mini">
							<span class="stat-mini-num">{r5reloadedContributors.length}</span>
							<span class="stat-mini-label">Reloaded</span>
						</div>
					</div>
				</div>

				<nav class="sidebar-nav">
					<a href="#supporters" class="nav-item">
						<span class="nav-icon supporter-icon">
							<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"/></svg>
						</span>
						Supporters
						<span class="count">{supporters.length}</span>
					</a>
					<a href="#valkyrie" class="nav-item active">
						<span class="nav-icon valkyrie-icon">
							<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"/><circle cx="9" cy="7" r="4"/><path d="M23 21v-2a4 4 0 0 0-3-3.87"/><path d="M16 3.13a4 4 0 0 1 0 7.75"/></svg>
						</span>
						R5Valkyrie
						<span class="count">{valkyrieContributors.length}</span>
					</a>
					<a href="#r5reloaded" class="nav-item">
						<span class="nav-icon reloaded-icon">
							<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"/><circle cx="9" cy="7" r="4"/><path d="M23 21v-2a4 4 0 0 0-3-3.87"/><path d="M16 3.13a4 4 0 0 1 0 7.75"/></svg>
						</span>
						R5Reloaded
						<span class="count">{r5reloadedContributors.length}</span>
					</a>
				</nav>

				<div class="sidebar-cta">
					<p>Want to contribute?</p>
					<a href="https://github.com/r5valkyrie/" target="_blank" class="btn-contribute">
						<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
							<path d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"/>
						</svg>
						View on GitHub
					</a>
				</div>
			</div>
		</aside>

		<main class="contributors-main">
			<!-- Hero Banner -->
			<div class="contributors-hero">
				<div class="hero-bg-glow"></div>
				<div class="hero-content">
					<h1>Our <span class="text-gradient">Contributors</span></h1>
					<p>The amazing people who build, support, and champion R5Valkyrie. None of this would be possible without them.</p>
					<div class="hero-avatars">
						{[...valkyrieContributors, ...r5reloadedContributors].slice(0, 5).map((c: any) => (
							<img src={c.avatar} alt={c.name} loading="lazy" crossorigin="anonymous" class="hero-avatar-mini" />
						))}
						{(valkyrieContributors.length + r5reloadedContributors.length) > 5 && (
							<span class="hero-avatar-more">+{valkyrieContributors.length + r5reloadedContributors.length - 5}</span>
						)}
					</div>
				</div>
			</div>

			{supporters.length > 0 && (
			<section id="supporters" class="contributors-section">
				<div class="section-header">
					<div class="section-icon supporter-accent">
						<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"/></svg>
					</div>
					<div>
						<h2>Supporters</h2>
						<p>Community members who help keep the project alive</p>
					</div>
				</div>
				<div class="contributors-grid">
					{
						supporters.map((supporter: any, index: number) => (
							<div
								class="contributor-card supporter-card"
								style={`animation-delay: ${index * 0.04}s`}
							>
								<div class="card-accent supporter-bar"></div>
								<div class="avatar-wrapper supporter-avatar">
									<img
										src={supporter.avatar}
										alt={supporter.name}
										loading="lazy"
										crossorigin="anonymous"
									/>
								</div>
								<div class="contributor-info">
									<h3>{supporter.name}</h3>
									<span class="role discord-tag">
										<svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 24 24" fill="currentColor">
											<path d="M20.317 4.37a19.791 19.791 0 0 0-4.885-1.515.074.074 0 0 0-.079.037c-.21.375-.444.864-.608 1.25a18.27 18.27 0 0 0-5.487 0 12.64 12.64 0 0 0-.617-1.25.077.077 0 0 0-.079-.037A19.736 19.736 0 0 0 3.677 4.37a.07.07 0 0 0-.032.027C.533 9.046-.32 13.58.099 18.057a.082.082 0 0 0 .031.057 19.9 19.9 0 0 0 5.993 3.03.078.078 0 0 0 .084-.028 14.09 14.09 0 0 0 1.226-1.994.076.076 0 0 0-.041-.106 13.107 13.107 0 0 1-1.872-.892.077.077 0 0 1-.008-.128 10.2 10.2 0 0 0 .372-.292.074.074 0 0 1 .077-.01c3.928 1.793 8.18 1.793 12.062 0a.074.074 0 0 1 .078.01c.12.098.246.198.373.292a.077.077 0 0 1-.006.127 12.299 12.299 0 0 1-1.873.892.077.077 0 0 0-.041.107c.36.698.772 1.362 1.225 1.993a.076.076 0 0 0 .084.028 19.839 19.839 0 0 0 6.002-3.03.077.077 0 0 0 .032-.054c.5-5.177-.838-9.674-3.549-13.66a.061.061 0 0 0-.031-.03zM8.02 15.33c-1.183 0-2.157-1.085-2.157-2.419 0-1.333.956-2.419 2.157-2.419 1.21 0 2.176 1.096 2.157 2.42 0 1.333-.956 2.418-2.157 2.418zm7.975 0c-1.183 0-2.157-1.085-2.157-2.419 0-1.333.955-2.419 2.157-2.419 1.21 0 2.176 1.096 2.157 2.42 0 1.333-.946 2.418-2.157 2.418z"/>
										</svg>
										{supporter.discord}
									</span>
								</div>
							</div>
						))
					}
				</div>
			</section>
			)}
			
			<section id="valkyrie" class="contributors-section">
				<div class="section-header">
					<div class="section-icon valkyrie-accent">
						<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"/><circle cx="9" cy="7" r="4"/><path d="M23 21v-2a4 4 0 0 0-3-3.87"/><path d="M16 3.13a4 4 0 0 1 0 7.75"/></svg>
					</div>
					<div>
						<h2>R5Valkyrie Contributors</h2>
						<p>The team building the future of Apex Legends modding</p>
					</div>
				</div>
				<div class="contributors-grid">
					{
						valkyrieContributors.map((contributor: any, index: number) => (
							<a
								href={contributor.url}
								target="_blank"
								class="contributor-card valkyrie-card"
								style={`animation-delay: ${index * 0.04}s`}
							>
								<div class="card-accent valkyrie-bar"></div>
								<div class="avatar-wrapper">
									<img
										src={contributor.avatar}
										alt={contributor.name}
										loading="lazy"
										crossorigin="anonymous"
									/>
								</div>
								<div class="contributor-info">
									<h3>{contributor.name}</h3>
									<span class="role">
										{contributor.description || "Contributor"}
									</span>
								</div>
								<div class="card-link">
									<svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"/><polyline points="15 3 21 3 21 9"/><line x1="10" y1="14" x2="21" y2="3"/></svg>
								</div>
							</a>
						))
					}
				</div>
			</section>

			<section id="r5reloaded" class="contributors-section">
				<div class="section-header">
					<div class="section-icon reloaded-accent">
						<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="23 4 23 10 17 10"></polyline><path d="M20.49 15a9 9 0 1 1-2.12-9.36L23 10"></path></svg>
					</div>
					<div>
						<h2>R5Reloaded Contributors</h2>
						<p>The foundation that made this all possible</p>
					</div>
				</div>
				<div class="contributors-grid">
					{
						r5reloadedContributors.map((contributor: any, index: number) => (
							<a
								href={contributor.url}
								target="_blank"
								class="contributor-card reloaded-card"
								style={`animation-delay: ${index * 0.04}s`}
							>
								<div class="card-accent reloaded-bar"></div>
								<div class="avatar-wrapper">
									<img
										src={contributor.avatar}
										alt={contributor.name}
										loading="lazy"
										crossorigin="anonymous"
									/>
								</div>
								<div class="contributor-info">
									<h3>{contributor.name}</h3>
									<span class="role">
										{contributor.description || "Contributor"}
									</span>
								</div>
								<div class="card-link">
									<svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"/><polyline points="15 3 21 3 21 9"/><line x1="10" y1="14" x2="21" y2="3"/></svg>
								</div>
							</a>
						))
					}
				</div>
			</section>
		</main>
	</div>
</Main>

<style>
	/* ===== Layout ===== */
	.contributors-wrapper {
		display: flex;
		min-height: 100vh;
		padding-top: 80px;
	}

	/* ===== Sidebar ===== */
	.contributors-sidebar {
		width: 300px;
		position: fixed;
		top: 80px;
		bottom: 0;
		left: 0;
		background: #0a0a0c;
		border-right: 1px solid var(--border-light);
		z-index: 10;
		display: flex;
		flex-direction: column;
	}

	.sidebar-header {
		padding: 20px 24px;
		border-bottom: 1px solid var(--border-light);
	}

	.sidebar-header h3 {
		font-size: 1.15rem;
		font-weight: 600;
		color: var(--text-main);
		margin: 0;
	}

	.sidebar-content {
		flex: 1;
		overflow-y: auto;
		padding: 20px 24px;
		display: flex;
		flex-direction: column;
		gap: 0;
	}

	/* ===== Sidebar Stats ===== */
	.sidebar-stats {
		padding: 0 0 20px 0;
		border-bottom: 1px solid var(--border-light);
		margin-bottom: 20px;
	}

	.stat-row {
		display: flex;
		align-items: baseline;
		gap: 10px;
		margin-bottom: 14px;
	}

	.stat-number {
		font-size: 2rem;
		font-weight: 700;
		color: var(--text-main);
		line-height: 1;
	}

	.stat-label {
		font-size: 0.8rem;
		color: var(--text-muted);
		text-transform: uppercase;
		letter-spacing: 0.05em;
	}

	.stat-divider {
		height: 1px;
		background: var(--border-light);
		margin-bottom: 14px;
	}

	.stat-breakdown {
		display: flex;
		gap: 16px;
	}

	.stat-mini {
		display: flex;
		flex-direction: column;
		gap: 2px;
	}

	.stat-mini-num {
		font-size: 1.1rem;
		font-weight: 600;
		color: var(--text-main);
	}

	.stat-mini-label {
		font-size: 0.7rem;
		color: var(--text-dim);
		text-transform: uppercase;
		letter-spacing: 0.04em;
	}

	/* ===== Sidebar Nav ===== */
	.sidebar-nav {
		display: flex;
		flex-direction: column;
		gap: 4px;
		margin-bottom: 24px;
	}

	.nav-item {
		display: flex;
		align-items: center;
		gap: 10px;
		padding: 10px 14px;
		border-radius: 10px;
		color: var(--text-muted);
		text-decoration: none;
		transition: all 0.2s ease;
		font-size: 0.88rem;
		font-weight: 500;
	}

	.nav-item:hover {
		background: rgba(255, 255, 255, 0.05);
		color: var(--text-main);
	}

	.nav-item.active {
		background: rgba(99, 102, 241, 0.12);
		color: var(--primary);
	}

	.nav-icon {
		display: flex;
		align-items: center;
		opacity: 0.65;
	}

	.supporter-icon { color: #f97316; }
	.valkyrie-icon { color: var(--primary); }
	.reloaded-icon { color: #22d3ee; }

	.nav-item.active .nav-icon { opacity: 1; }

	.nav-item .count {
		margin-left: auto;
		font-size: 0.72rem;
		font-weight: 600;
		background: rgba(255, 255, 255, 0.08);
		padding: 2px 8px;
		border-radius: 10px;
		color: var(--text-dim);
	}

	.nav-item.active .count {
		background: rgba(99, 102, 241, 0.25);
		color: var(--primary);
	}

	/* ===== Sidebar CTA ===== */
	.sidebar-cta {
		margin-top: auto;
		border-top: 1px solid var(--border-light);
		padding-top: 20px;
		text-align: center;
	}

	.sidebar-cta p {
		color: var(--text-dim);
		font-size: 0.82rem;
		margin-bottom: 12px;
	}

	.btn-contribute {
		display: inline-flex;
		align-items: center;
		justify-content: center;
		gap: 8px;
		padding: 10px 20px;
		background: rgba(255, 255, 255, 0.04);
		border: 1px solid var(--border-light);
		border-radius: 10px;
		color: var(--text-muted);
		text-decoration: none;
		font-size: 0.85rem;
		font-weight: 500;
		transition: all 0.2s ease;
		width: 100%;
	}

	.btn-contribute:hover {
		background: rgba(99, 102, 241, 0.12);
		border-color: rgba(99, 102, 241, 0.3);
		color: var(--primary);
	}

	/* ===== Scrollbar ===== */
	.custom-scrollbar::-webkit-scrollbar { width: 5px; }
	.custom-scrollbar::-webkit-scrollbar-track { background: transparent; }
	.custom-scrollbar::-webkit-scrollbar-thumb { background: rgba(255, 255, 255, 0.08); border-radius: 3px; }
	.custom-scrollbar::-webkit-scrollbar-thumb:hover { background: rgba(255, 255, 255, 0.15); }

	/* ===== Main Content ===== */
	.contributors-main {
		flex: 1;
		margin-left: 300px;
		background: #0a0a0c;
	}

	/* ===== Hero ===== */
	.contributors-hero {
		position: relative;
		padding: 56px 40px 48px;
		border-bottom: 1px solid var(--border-light);
		overflow: hidden;
	}

	.hero-bg-glow {
		position: absolute;
		top: -40%;
		left: 50%;
		transform: translateX(-50%);
		width: 600px;
		height: 300px;
		background: radial-gradient(ellipse, rgba(99, 102, 241, 0.1) 0%, transparent 70%);
		pointer-events: none;
	}

	.hero-content {
		position: relative;
		z-index: 1;
		max-width: 600px;
	}

	.hero-content h1 {
		font-size: 2.2rem;
		font-weight: 700;
		color: var(--text-main);
		margin-bottom: 12px;
		line-height: 1.2;
	}

	.text-gradient {
		background: linear-gradient(135deg, var(--primary) 0%, #a78bfa 50%, var(--accent) 100%);
		-webkit-background-clip: text;
		-webkit-text-fill-color: transparent;
		background-clip: text;
	}

	.hero-content p {
		font-size: 1rem;
		color: var(--text-muted);
		line-height: 1.7;
		margin-bottom: 24px;
	}

	.hero-avatars {
		display: flex;
		align-items: center;
		gap: 6px;
	}

	.hero-avatar-mini {
		width: 40px;
		height: 40px;
		border-radius: 50%;
		border: 2px solid rgba(255, 255, 255, 0.1);
		object-fit: cover;
		transition: transform 0.2s ease, border-color 0.2s ease;
	}

	.hero-avatar-mini:hover {
		transform: scale(1.1);
		border-color: rgba(99, 102, 241, 0.4);
		z-index: 2;
	}

	.hero-avatar-more {
		width: 40px;
		height: 40px;
		border-radius: 50%;
		border: 2px solid rgba(255, 255, 255, 0.1);
		background: rgba(99, 102, 241, 0.15);
		color: var(--primary);
		font-size: 0.72rem;
		font-weight: 600;
		display: flex;
		align-items: center;
		justify-content: center;
	}

	/* ===== Sections ===== */
	.contributors-section {
		padding: 40px 40px 48px;
		border-bottom: 1px solid rgba(255, 255, 255, 0.04);
	}

	.contributors-section:last-child {
		border-bottom: none;
	}

	.section-header {
		display: flex;
		align-items: center;
		gap: 16px;
		margin-bottom: 28px;
	}

	.section-icon {
		width: 42px;
		height: 42px;
		border-radius: 12px;
		display: flex;
		align-items: center;
		justify-content: center;
		flex-shrink: 0;
	}

	.supporter-accent {
		background: rgba(249, 115, 22, 0.12);
		color: #f97316;
	}

	.valkyrie-accent {
		background: rgba(99, 102, 241, 0.12);
		color: var(--primary);
	}

	.reloaded-accent {
		background: rgba(34, 211, 238, 0.12);
		color: #22d3ee;
	}

	.section-header h2 {
		font-size: 1.35rem;
		font-weight: 600;
		margin-bottom: 2px;
		color: var(--text-main);
	}

	.section-header p {
		color: var(--text-dim);
		font-size: 0.85rem;
		margin: 0;
	}

	/* ===== Grid ===== */
	.contributors-grid {
		display: grid;
		grid-template-columns: repeat(auto-fill, minmax(210px, 1fr));
		gap: 16px;
	}

	/* ===== Cards ===== */
	.contributor-card {
		position: relative;
		background: rgba(255, 255, 255, 0.025);
		border: 1px solid rgba(255, 255, 255, 0.06);
		border-radius: 14px;
		padding: 24px 18px 20px;
		display: flex;
		flex-direction: column;
		align-items: center;
		text-align: center;
		text-decoration: none;
		transition: all 0.25s ease;
		overflow: hidden;
		animation: fadeInUp 0.4s ease forwards;
		opacity: 0;
	}

	@keyframes fadeInUp {
		from { opacity: 0; transform: translateY(16px); }
		to { opacity: 1; transform: translateY(0); }
	}

	.card-accent {
		position: absolute;
		top: 0;
		left: 0;
		right: 0;
		height: 3px;
		opacity: 0;
		transition: opacity 0.25s ease;
	}

	.valkyrie-bar { background: linear-gradient(90deg, var(--primary), #a78bfa); }
	.supporter-bar { background: linear-gradient(90deg, #f97316, #fbbf24); }
	.reloaded-bar { background: linear-gradient(90deg, #22d3ee, #06b6d4); }

	.contributor-card:hover .card-accent { opacity: 1; }

	.contributor-card:hover {
		transform: translateY(-3px);
		background: rgba(255, 255, 255, 0.045);
		border-color: rgba(255, 255, 255, 0.1);
		box-shadow: 0 16px 40px rgba(0, 0, 0, 0.25);
	}

	/* Card â€” type-specific hover borders */
	.valkyrie-card:hover { border-color: rgba(99, 102, 241, 0.25); }
	.supporter-card:hover { border-color: rgba(249, 115, 22, 0.25); }
	.reloaded-card:hover { border-color: rgba(34, 211, 238, 0.25); }

	.supporter-card { cursor: default; }

	/* ===== Avatar ===== */
	.avatar-wrapper {
		width: 72px;
		height: 72px;
		border-radius: 50%;
		overflow: hidden;
		margin-bottom: 14px;
		border: 2px solid rgba(255, 255, 255, 0.08);
		background: rgba(0, 0, 0, 0.3);
		position: relative;
		z-index: 1;
		transition: all 0.25s ease;
	}

	.avatar-wrapper img {
		width: 100%;
		height: 100%;
		object-fit: cover;
	}

	.contributor-card:hover .avatar-wrapper {
		border-color: rgba(99, 102, 241, 0.4);
		box-shadow: 0 0 16px rgba(99, 102, 241, 0.15);
	}

	.supporter-card:hover .supporter-avatar {
		border-color: rgba(249, 115, 22, 0.4);
		box-shadow: 0 0 16px rgba(249, 115, 22, 0.15);
	}

	.reloaded-card:hover .avatar-wrapper {
		border-color: rgba(34, 211, 238, 0.4);
		box-shadow: 0 0 16px rgba(34, 211, 238, 0.15);
	}

	/* ===== Info ===== */
	.contributor-info {
		position: relative;
		z-index: 1;
	}

	.contributor-info h3 {
		font-size: 0.95rem;
		font-weight: 600;
		margin-bottom: 8px;
		color: var(--text-main);
	}

	.role {
		font-size: 0.72rem;
		color: var(--text-muted);
		background: rgba(255, 255, 255, 0.05);
		padding: 4px 12px;
		border-radius: 20px;
		display: inline-flex;
		align-items: center;
		gap: 5px;
	}

	.discord-tag {
		color: #7289da;
		background: rgba(114, 137, 218, 0.1);
	}

	.discord-tag svg { flex-shrink: 0; }

	.card-link {
		position: absolute;
		top: 14px;
		right: 14px;
		color: var(--text-dim);
		opacity: 0;
		transition: all 0.2s ease;
	}

	.contributor-card:hover .card-link {
		opacity: 1;
		color: var(--primary);
	}

	/* ===== Mobile ===== */
	@media (max-width: 1024px) {
		.contributors-sidebar { width: 260px; }
		.contributors-main { margin-left: 260px; }
		.contributors-hero { padding: 40px 28px 36px; }
		.contributors-section { padding: 32px 28px 40px; }
	}

	@media (max-width: 768px) {
		.contributors-wrapper {
			flex-direction: column;
			padding-top: 60px;
		}

		.contributors-sidebar {
			position: relative;
			width: 100%;
			top: 0;
			height: auto;
			border-right: none;
			border-bottom: 1px solid var(--border-light);
		}

		.sidebar-header { display: none; }

		.sidebar-content {
			padding: 12px 16px;
			flex-direction: row;
			flex-wrap: wrap;
			align-items: center;
			gap: 12px;
		}

		.sidebar-stats { display: none; }

		.sidebar-nav {
			flex-direction: row;
			overflow-x: auto;
			margin-bottom: 0;
			gap: 6px;
			flex: 1;
		}

		.nav-item {
			white-space: nowrap;
			padding: 8px 14px;
			font-size: 0.82rem;
		}

		.sidebar-cta { display: none; }

		.contributors-main { margin-left: 0; }

		.contributors-hero {
			padding: 32px 20px 28px;
		}

		.hero-content h1 { font-size: 1.6rem; }
		.hero-content p { font-size: 0.9rem; }

		.contributors-section { padding: 28px 20px 36px; }

		.section-header { gap: 12px; margin-bottom: 20px; }
		.section-icon { width: 36px; height: 36px; border-radius: 10px; }
		.section-header h2 { font-size: 1.15rem; }

		.contributors-grid {
			grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
			gap: 10px;
		}

		.contributor-card { padding: 18px 14px 16px; }
		.avatar-wrapper { width: 56px; height: 56px; }
		.contributor-info h3 { font-size: 0.85rem; }
		.role { font-size: 0.68rem; padding: 3px 10px; }
	}

	@media (max-width: 480px) {
		.contributors-grid {
			grid-template-columns: repeat(2, 1fr);
			gap: 8px;
		}
	}
</style>

<script>
	function initContributorsScrollSpy() {
		const sections = document.querySelectorAll('.contributors-section');
		const navItems = document.querySelectorAll('.nav-item');
		if (!sections.length || !navItems.length) return;

		const observer = new IntersectionObserver((entries) => {
			entries.forEach(entry => {
				if (entry.isIntersecting) {
					const id = entry.target.getAttribute('id');
					navItems.forEach(item => {
						item.classList.remove('active');
						if (item.getAttribute('href') === `#${id}`) {
							item.classList.add('active');
						}
					});
				}
			});
		}, { rootMargin: '-20% 0px -80% 0px' });

		sections.forEach(section => observer.observe(section));
	}

	// Support Astro ClientRouter (view transitions)
	document.addEventListener('astro:page-load', initContributorsScrollSpy);
</script>
