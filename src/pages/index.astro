---
import Main from "../layouts/Main.astro";
---

<Main title="Home" fullWidth={true}>
	<section class="hero">
		<div class="hero-content fade-in">
			<h1>
				The Future of <span class="text-gradient">Apex Legends</span>
			</h1>
			<p class="hero-text">
				Experience the game like never before with custom servers,
				modding support, and a thriving community.
			</p>
			<div class="hero-actions">
				<a href="/download" class="btn btn-primary">Download Now</a>
				<a href="/docs" class="btn btn-secondary">Documentation</a>
			</div>
		</div>
	</section>

	<section class="showcase-section">
		<div class="container">
			<div class="section-header centered fade-in-on-scroll">
				<h2>Experience the Difference</h2>
				<p>See what makes R5Valkyrie unique.</p>
			</div>

			<div class="carousel-container fade-in-on-scroll" tabindex="0">
				<div class="carousel-track-container">
					<ul class="carousel-track">
						<li class="carousel-slide current-slide">
							<div class="showcase-item">
								<div class="showcase-image">
									<img
										src="/assets/showcase1.png"
										alt="Custom Gamemodes"
									/>
								</div>
								<div class="showcase-text">
									<span class="slide-number">01</span>
									<h3>Downloadable Mods</h3>
									<p>
										Download mods created by the community to
										enhance your experience.
									</p>
									<a href="/mods" class="slide-cta">
										Browse Mods
										<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="5" y1="12" x2="19" y2="12"/><polyline points="12 5 19 12 12 19"/></svg>
									</a>
									
								</div>
							</div>
						</li>
						<li class="carousel-slide">
							<div class="showcase-item">
								<div class="showcase-image">
									<img
										src="/assets/showcase2.png"
										alt="Modding Support"
									/>
								</div>
								<div class="showcase-text">
									<span class="slide-number">02</span>
									<h3>Full Modding Support</h3>
									<p>
										Customize every aspect of the game.
										Import custom assets, create new maps,
										and tweak weapon stats to your liking.
									</p>
									<a href="/docs" class="slide-cta">
										Read the Docs
										<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="5" y1="12" x2="19" y2="12"/><polyline points="12 5 19 12 12 19"/></svg>
									</a>
								</div>
							</div>
						</li>
						<li class="carousel-slide">
							<div class="showcase-item">
								<div class="showcase-image">
									<img
										src="/assets/showcase3.png"
										alt="Community Servers"
									/>
								</div>
								<div class="showcase-text">
									<span class="slide-number">03</span>
									<h3>Community Servers</h3>
									<p>
										Host your own dedicated servers with
										full control over settings, bans, and
										permissions. Join a community that fits
										your playstyle.
									</p>
									<a href="/servers" class="slide-cta">
										Browse Servers
										<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="5" y1="12" x2="19" y2="12"/><polyline points="12 5 19 12 12 19"/></svg>
									</a>
								</div>
							</div>
						</li>
					</ul>
				</div>

				<button class="carousel-button carousel-button--left is-hidden" aria-label="Previous slide">
					<svg
						xmlns="http://www.w3.org/2000/svg"
						width="24"
						height="24"
						viewBox="0 0 24 24"
						fill="none"
						stroke="currentColor"
						stroke-width="2"
						stroke-linecap="round"
						stroke-linejoin="round"
						><polyline points="15 18 9 12 15 6"></polyline></svg
					>
				</button>

				<button class="carousel-button carousel-button--right" aria-label="Next slide">
					<svg
						xmlns="http://www.w3.org/2000/svg"
						width="24"
						height="24"
						viewBox="0 0 24 24"
						fill="none"
						stroke="currentColor"
						stroke-width="2"
						stroke-linecap="round"
						stroke-linejoin="round"
						><polyline points="9 18 15 12 9 6"></polyline></svg
					>
				</button>

				<div class="carousel-controls">
					<div class="carousel-nav">
						<button class="carousel-indicator current-slide" aria-label="Go to slide 1">
							<span class="indicator-progress"></span>
						</button>
						<button class="carousel-indicator" aria-label="Go to slide 2">
							<span class="indicator-progress"></span>
						</button>
						<button class="carousel-indicator" aria-label="Go to slide 3">
							<span class="indicator-progress"></span>
						</button>
					</div>
					<button class="carousel-pause" aria-label="Pause autoplay">
						<svg class="pause-icon" xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="currentColor"><rect x="6" y="4" width="4" height="16"/><rect x="14" y="4" width="4" height="16"/></svg>
						<svg class="play-icon" xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="currentColor"><polygon points="5 3 19 12 5 21 5 3"/></svg>
					</button>
				</div>
			</div>
		</div>
	</section>

	<section class="features">
		<div class="container">
			<div class="grid-3">
				<div class="feature-card fade-in-on-scroll">
					<div class="icon-box">
						<svg
							xmlns="http://www.w3.org/2000/svg"
							width="24"
							height="24"
							viewBox="0 0 24 24"
							fill="none"
							stroke="currentColor"
							stroke-width="2"
							stroke-linecap="round"
							stroke-linejoin="round"
							><rect
								x="2"
								y="3"
								width="20"
								height="14"
								rx="2"
								ry="2"></rect><line
								x1="8"
								y1="21"
								x2="16"
								y2="21"></line><line
								x1="12"
								y1="17"
								x2="12"
								y2="21"></line></svg
						>
					</div>
					<h3>Server Browser</h3>
					<p>
						Easily find and join community servers with our advanced
						server browser.
					</p>
				</div>
				<div class="feature-card fade-in-on-scroll">
					<div class="icon-box">
						<svg
							xmlns="http://www.w3.org/2000/svg"
							width="24"
							height="24"
							viewBox="0 0 24 24"
							fill="none"
							stroke="currentColor"
							stroke-width="2"
							stroke-linecap="round"
							stroke-linejoin="round"
							><polygon points="12 2 2 7 12 12 22 7 12 2"
							></polygon><polyline points="2 17 12 22 22 17"
							></polyline><polyline points="2 12 12 17 22 12"
							></polyline></svg
						>
					</div>
					<h3>Mod Manager</h3>
					<p>
						Install and manage mods with a single click using our
						integrated mod manager.
					</p>
				</div>
				<div class="feature-card fade-in-on-scroll">
					<div class="icon-box">
						<svg
							xmlns="http://www.w3.org/2000/svg"
							width="24"
							height="24"
							viewBox="0 0 24 24"
							fill="none"
							stroke="currentColor"
							stroke-width="2"
							stroke-linecap="round"
							stroke-linejoin="round"
							><path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"
							></path><circle cx="9" cy="7" r="4"></circle><path
								d="M23 21v-2a4 4 0 0 0-3-3.87"></path><path
								d="M16 3.13a4 4 0 0 1 0 7.75"></path></svg
						>
					</div>
					<h3>Open Source</h3>
					<p>
						R5Valkyrie is open source and community driven. Join us
						on GitHub!
					</p>
				</div>
			</div>
		</div>
	</section>

	<section class="cta-section">
		<div class="container">
			<div class="cta-box fade-in-on-scroll">
				<h2>Ready to jump in?</h2>
				<p>Join us on R5Valkyrie today.</p>
				<a
					href="https://discord.gg/GcJSMUGJyD"
					target="_blank"
					class="btn btn-primary">Join Discord</a
				>
			</div>
		</div>
	</section>
</Main>

<style>
	.hero {
		min-height: 100vh;
		display: flex;
		align-items: center;
		justify-content: center;
		text-align: center;
		padding: 60px 20px;
		position: relative;
		overflow: hidden;
	}

	.hero-content {
		display: flex;
		flex-direction: column;
		align-items: center;
		gap: 24px;
		position: relative;
		z-index: 1;
	}

	.hero-badge {
		background: rgba(99, 102, 241, 0.1);
		color: var(--primary);
		padding: 6px 16px;
		border-radius: var(--radius-full);
		font-size: 0.9rem;
		font-weight: 600;
		border: 1px solid rgba(99, 102, 241, 0.2);
		backdrop-filter: blur(10px);
	}

	.hero-text {
		font-size: 1.25rem;
		color: var(--text-muted);
		max-width: 600px;
		line-height: 1.6;
	}

	.hero-actions {
		display: flex;
		gap: 16px;
		margin-top: 10px;
	}

	/* Showcase Section */
	.showcase-section {
		padding: 100px 0;
		background: linear-gradient(
			180deg,
			rgba(8, 8, 12, 1) 0%,
			rgba(5, 5, 8, 1) 100%
		);
		overflow: hidden;
		position: relative;
	}

	.showcase-section::before {
		content: '';
		position: absolute;
		top: 0;
		left: 50%;
		transform: translateX(-50%);
		width: 150%;
		height: 1px;
		background: linear-gradient(
			90deg,
			transparent 0%,
			rgba(99, 102, 241, 0.3) 50%,
			transparent 100%
		);
	}

	.showcase-section::after {
		content: '';
		position: absolute;
		top: 50%;
		left: 50%;
		transform: translate(-50%, -50%);
		width: 800px;
		height: 800px;
		background: radial-gradient(circle, rgba(99, 102, 241, 0.08) 0%, transparent 60%);
		pointer-events: none;
	}

	.section-header.centered {
		text-align: center;
		margin-bottom: 60px;
		position: relative;
		z-index: 1;
	}

	.section-header h2 {
		font-size: 2.5rem;
		margin-bottom: 10px;
	}

	.section-header p {
		color: var(--text-muted);
		font-size: 1.2rem;
	}

	/* Carousel Styles - Enhanced */
	.carousel-container {
		position: relative;
		height: 600px;
		width: 100%;
		max-width: 1400px;
		margin: 0 auto;
		overflow: hidden;
		border-radius: 20px;
		box-shadow: 0 25px 60px rgba(0, 0, 0, 0.5);
		outline: none;
	}

	.carousel-container:focus-visible {
		box-shadow: 0 25px 60px rgba(0, 0, 0, 0.5), 0 0 0 3px var(--primary);
	}

	.carousel-track-container {
		height: 100%;
		position: relative;
		overflow: hidden;
	}

	.carousel-track {
		padding: 0;
		margin: 0;
		list-style: none;
		position: relative;
		height: 100%;
		transition: transform 0.6s cubic-bezier(0.4, 0, 0.2, 1);
	}

	.carousel-slide {
		position: absolute;
		top: 0;
		bottom: 0;
		width: 100%;
		height: 100%;
		opacity: 0;
		transition: opacity 0.4s ease;
	}

	.carousel-slide.current-slide {
		opacity: 1;
	}

	.showcase-item {
		position: relative;
		width: 100%;
		height: 100%;
		display: flex;
		overflow: hidden;
	}

	/* Image as Background */
	.showcase-image {
		position: absolute;
		inset: 0;
		z-index: 1;
		width: 100%;
		height: 100%;
	}

	.showcase-image::after {
		content: '';
		position: absolute;
		inset: 0;
		background: linear-gradient(
			135deg,
			rgba(0, 0, 0, 0.4) 0%,
			rgba(0, 0, 0, 0.1) 50%,
			rgba(0, 0, 0, 0.3) 100%
		);
		z-index: 2;
	}

	.showcase-image img {
		width: 100%;
		height: 100%;
		object-fit: cover;
		transition: transform 8s ease;
	}

	.carousel-slide.current-slide .showcase-image img {
		transform: scale(1.08);
	}

	/* Text as Glass Overlay */
	.showcase-text {
		position: absolute;
		bottom: 50px;
		left: 50px;
		z-index: 3;
		max-width: 520px;
		background: rgba(10, 10, 15, 0.8);
		backdrop-filter: blur(20px);
		padding: 32px 36px;
		border-radius: 16px;
		border: 1px solid rgba(255, 255, 255, 0.08);
		box-shadow: 0 16px 48px rgba(0, 0, 0, 0.4);
		transform: translateY(20px);
		opacity: 0;
		transition: all 0.5s cubic-bezier(0.4, 0, 0.2, 1) 0.2s;
	}

	.carousel-slide.current-slide .showcase-text {
		transform: translateY(0);
		opacity: 1;
	}

	.slide-number {
		display: inline-block;
		font-size: 0.75rem;
		font-weight: 700;
		letter-spacing: 0.15em;
		color: var(--primary);
		margin-bottom: 12px;
		padding: 4px 10px;
		background: rgba(99, 102, 241, 0.15);
		border-radius: 4px;
	}

	.showcase-text h3 {
		font-size: 2rem;
		margin-bottom: 12px;
		color: #fff;
		line-height: 1.2;
		font-weight: 700;
	}

	.showcase-text p {
		font-size: 1rem;
		line-height: 1.7;
		margin-bottom: 20px;
		color: rgba(255, 255, 255, 0.75);
	}

	.slide-cta {
		display: inline-flex;
		align-items: center;
		gap: 8px;
		font-size: 0.9rem;
		font-weight: 600;
		color: var(--primary);
		text-decoration: none;
		transition: all 0.2s ease;
	}

	.slide-cta:hover {
		color: #fff;
		gap: 12px;
	}

	.slide-cta svg {
		transition: transform 0.2s ease;
	}

	.slide-cta:hover svg {
		transform: translateX(4px);
	}

	/* Navigation Buttons */
	.carousel-button {
		position: absolute;
		top: 50%;
		transform: translateY(-50%);
		background: rgba(0, 0, 0, 0.4);
		border: 1px solid rgba(255, 255, 255, 0.15);
		color: white;
		width: 52px;
		height: 52px;
		border-radius: 50%;
		cursor: pointer;
		z-index: 10;
		display: flex;
		align-items: center;
		justify-content: center;
		transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
		backdrop-filter: blur(10px);
		opacity: 0;
	}

	.carousel-container:hover .carousel-button {
		opacity: 1;
	}

	.carousel-button:hover {
		background: var(--primary);
		border-color: var(--primary);
		box-shadow: 0 0 30px rgba(99, 102, 241, 0.5);
		transform: translateY(-50%) scale(1.1);
	}

	.carousel-button:active {
		transform: translateY(-50%) scale(0.95);
	}

	.carousel-button--left {
		left: 20px;
	}

	.carousel-button--right {
		right: 20px;
	}

	.carousel-button.is-hidden {
		opacity: 0 !important;
		pointer-events: none;
	}

	/* Controls Container */
	.carousel-controls {
		position: absolute;
		bottom: 24px;
		right: 24px;
		z-index: 10;
		display: flex;
		align-items: center;
		gap: 16px;
		background: rgba(0, 0, 0, 0.5);
		backdrop-filter: blur(12px);
		padding: 10px 14px;
		border-radius: 30px;
		border: 1px solid rgba(255, 255, 255, 0.1);
	}

	/* Indicators */
	.carousel-nav {
		display: flex;
		gap: 6px;
	}

	.carousel-indicator {
		border: 0;
		border-radius: 3px;
		width: 32px;
		height: 4px;
		background: rgba(255, 255, 255, 0.25);
		cursor: pointer;
		transition: all 0.3s ease;
		position: relative;
		overflow: hidden;
		padding: 0;
	}

	.indicator-progress {
		position: absolute;
		left: 0;
		top: 0;
		height: 100%;
		width: 0%;
		background: var(--primary);
		border-radius: 3px;
	}

	.carousel-indicator.current-slide {
		background: rgba(255, 255, 255, 0.3);
		width: 48px;
	}

	.carousel-indicator.current-slide .indicator-progress {
		animation: progress-fill 6s linear forwards;
	}

	.carousel-container.paused .carousel-indicator.current-slide .indicator-progress {
		animation-play-state: paused;
	}

	@keyframes progress-fill {
		from { width: 0%; }
		to { width: 100%; }
	}

	.carousel-indicator:hover {
		background: rgba(255, 255, 255, 0.4);
	}

	/* Pause Button */
	.carousel-pause {
		background: transparent;
		border: none;
		color: rgba(255, 255, 255, 0.7);
		cursor: pointer;
		padding: 4px;
		display: flex;
		align-items: center;
		justify-content: center;
		transition: all 0.2s ease;
		border-radius: 4px;
	}

	.carousel-pause:hover {
		color: white;
		background: rgba(255, 255, 255, 0.1);
	}

	.carousel-pause .play-icon {
		display: none;
	}

	.carousel-container.paused .carousel-pause .pause-icon {
		display: none;
	}

	.carousel-container.paused .carousel-pause .play-icon {
		display: block;
	}

	/* Mobile Responsive */
	@media (max-width: 768px) {
		.carousel-container {
			height: 550px;
			border-radius: 0;
		}

		.showcase-text {
			bottom: 0;
			left: 0;
			right: 0;
			max-width: 100%;
			border-radius: 20px 20px 0 0;
			padding: 24px 20px;
			border: none;
			border-top: 1px solid rgba(255, 255, 255, 0.1);
		}

		.showcase-text h3 {
			font-size: 1.5rem;
		}

		.showcase-text p {
			font-size: 0.9rem;
			margin-bottom: 16px;
		}

		.carousel-controls {
			bottom: auto;
			top: 16px;
			right: 16px;
			padding: 8px 12px;
		}

		.carousel-button {
			width: 40px;
			height: 40px;
			opacity: 1;
		}

		.carousel-button--left {
			left: 12px;
		}

		.carousel-button--right {
			right: 12px;
		}
	}

	.features {
		padding: 100px 0;
		background: linear-gradient(
			180deg,
			rgba(8, 8, 12, 1) 0%,
			rgba(5, 5, 8, 1) 100%
		);
		position: relative;
	}

	.features::before {
		content: '';
		position: absolute;
		top: 0;
		left: 50%;
		transform: translateX(-50%);
		width: 150%;
		height: 1px;
		background: linear-gradient(
			90deg,
			transparent 0%,
			rgba(99, 102, 241, 0.3) 50%,
			transparent 100%
		);
	}

	.features::after {
		content: '';
		position: absolute;
		top: 50%;
		left: 50%;
		transform: translate(-50%, -50%);
		width: 600px;
		height: 600px;
		background: radial-gradient(circle, rgba(99, 102, 241, 0.06) 0%, transparent 60%);
		pointer-events: none;
	}

	.grid-3 {
		display: grid;
		grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
		gap: 30px;
		position: relative;
		z-index: 1;
	}

	.feature-card {
		background: rgba(15, 15, 20, 0.8);
		border: 1px solid rgba(255, 255, 255, 0.06);
		padding: 40px 30px;
		border-radius: var(--radius-lg);
		transition: all 0.3s ease;
		backdrop-filter: blur(10px);
		position: relative;
		z-index: 1;
	}

	.feature-card:hover {
		transform: translateY(-5px);
		background: rgba(20, 20, 28, 0.9);
		border-color: rgba(99, 102, 241, 0.3);
		box-shadow: 0 20px 40px rgba(0, 0, 0, 0.4);
	}

	.icon-box {
		width: 50px;
		height: 50px;
		background: rgba(255, 255, 255, 0.05);
		border-radius: 12px;
		display: flex;
		align-items: center;
		justify-content: center;
		margin-bottom: 20px;
		color: var(--primary);
	}

	.feature-card h3 {
		margin-bottom: 10px;
		font-size: 1.5rem;
	}

	.feature-card p {
		color: var(--text-muted);
	}

	.cta-section {
		padding: 80px 0 120px;
		background: linear-gradient(
			180deg,
			rgba(10, 10, 15, 1) 0%,
			rgba(8, 8, 12, 1) 100%
		);
		position: relative;
		overflow: hidden;
	}

	.cta-section::before {
		content: '';
		position: absolute;
		top: 0;
		left: 50%;
		transform: translateX(-50%);
		width: 150%;
		height: 1px;
		background: linear-gradient(
			90deg,
			transparent 0%,
			rgba(99, 102, 241, 0.3) 50%,
			transparent 100%
		);
	}

	.cta-section::after {
		content: '';
		position: absolute;
		bottom: -200px;
		left: 50%;
		transform: translateX(-50%);
		width: 600px;
		height: 600px;
		background: radial-gradient(circle, rgba(99, 102, 241, 0.15) 0%, transparent 70%);
		pointer-events: none;
	}

	.cta-box {
		background: rgba(15, 15, 20, 0.8);
		border: 1px solid rgba(255, 255, 255, 0.06);
		border-radius: var(--radius-lg);
		padding: 70px 60px;
		text-align: center;
		display: flex;
		flex-direction: column;
		position: relative;
		z-index: 1;
		backdrop-filter: blur(10px);
		align-items: center;
		gap: 20px;
	}

	.cta-box h2 {
		font-size: 2.5rem;
	}

	.cta-box p {
		font-size: 1.2rem;
		color: var(--text-muted);
		margin-bottom: 10px;
	}

	@media (max-width: 768px) {
		.hero-actions {
			flex-direction: column;
			width: 100%;
		}

		.btn {
			width: 100%;
		}
	}
</style>

<script>
	function setupCarousel() {
		const container = document.querySelector('.carousel-container') as HTMLElement | null;
		const track = document.querySelector('.carousel-track') as HTMLElement | null;
		if (!track || !container) return;

		const slides = Array.from(track.children) as HTMLElement[];
		const nextButton = document.querySelector('.carousel-button--right') as HTMLElement | null;
		const prevButton = document.querySelector('.carousel-button--left') as HTMLElement | null;
		const dotsNav = document.querySelector('.carousel-nav') as HTMLElement | null;
		const dots = Array.from(dotsNav?.children || []) as HTMLElement[];
		const pauseButton = document.querySelector('.carousel-pause') as HTMLElement | null;

		if (slides.length === 0) return;

		const AUTOPLAY_INTERVAL = 6000;
		let autoplayTimer: number | null = null;
		let isPaused = false;
		let currentIndex = 0;
		let touchStartX = 0;
		let touchEndX = 0;

		// Set up slide positions
		const slideWidth = slides[0].getBoundingClientRect().width;
		slides.forEach((slide, index) => {
			slide.style.left = slideWidth * index + 'px';
		});

		// Trigger zoom animation on first slide
		const firstSlide = slides[0];
		if (firstSlide) {
			// Remove class, wait for next frame, then re-add to trigger animation
			firstSlide.classList.remove('current-slide');
			requestAnimationFrame(() => {
				requestAnimationFrame(() => {
					firstSlide.classList.add('current-slide');
				});
			});
		}

		const goToSlide = (targetIndex: number) => {
			if (targetIndex < 0 || targetIndex >= slides.length) return;

			const currentSlide = slides[currentIndex];
			const targetSlide = slides[targetIndex];
			const currentDot = dots[currentIndex];
			const targetDot = dots[targetIndex];

			// Update track position
			track.style.transform = `translateX(-${targetSlide.style.left})`;

			// Update slide classes
			currentSlide.classList.remove('current-slide');
			targetSlide.classList.add('current-slide');

			// Update dots
			if (currentDot && targetDot) {
				currentDot.classList.remove('current-slide');
				targetDot.classList.add('current-slide');
			}

			// Update arrows
			if (prevButton && nextButton) {
				prevButton.classList.toggle('is-hidden', targetIndex === 0);
				nextButton.classList.toggle('is-hidden', targetIndex === slides.length - 1);
			}

			currentIndex = targetIndex;

			// Restart autoplay timer
			if (!isPaused) {
				startAutoplay();
			}
		};

		const nextSlide = () => {
			const next = currentIndex < slides.length - 1 ? currentIndex + 1 : 0;
			goToSlide(next);
		};

		const prevSlide = () => {
			const prev = currentIndex > 0 ? currentIndex - 1 : slides.length - 1;
			goToSlide(prev);
		};

		const startAutoplay = () => {
			stopAutoplay();
			if (isPaused) return;

			autoplayTimer = window.setTimeout(() => {
				nextSlide();
			}, AUTOPLAY_INTERVAL);
		};

		const stopAutoplay = () => {
			if (autoplayTimer) {
				clearTimeout(autoplayTimer);
				autoplayTimer = null;
			}
		};

		const togglePause = () => {
			isPaused = !isPaused;
			container.classList.toggle('paused', isPaused);
			if (isPaused) {
				stopAutoplay();
			} else {
				startAutoplay();
			}
		};

		// Event Listeners
		if (prevButton) {
			prevButton.addEventListener('click', () => {
				prevSlide();
			});
		}

		if (nextButton) {
			nextButton.addEventListener('click', () => {
				nextSlide();
			});
		}

		if (dotsNav) {
			dotsNav.addEventListener('click', (e) => {
				const targetDot = (e.target as HTMLElement).closest('button.carousel-indicator');
				if (!targetDot) return;
				const targetIndex = dots.indexOf(targetDot as HTMLElement);
				if (targetIndex !== -1 && targetIndex !== currentIndex) {
					goToSlide(targetIndex);
				}
			});
		}

		if (pauseButton) {
			pauseButton.addEventListener('click', togglePause);
		}

		// Keyboard navigation
		container.addEventListener('keydown', (e) => {
			if (e.key === 'ArrowLeft') {
				e.preventDefault();
				prevSlide();
			} else if (e.key === 'ArrowRight') {
				e.preventDefault();
				nextSlide();
			} else if (e.key === ' ') {
				e.preventDefault();
				togglePause();
			}
		});

		// Touch/swipe support
		container.addEventListener('touchstart', (e) => {
			touchStartX = e.changedTouches[0].screenX;
		}, { passive: true });

		container.addEventListener('touchend', (e) => {
			touchEndX = e.changedTouches[0].screenX;
			const diff = touchStartX - touchEndX;
			const threshold = 50;

			if (Math.abs(diff) > threshold) {
				if (diff > 0) {
					nextSlide();
				} else {
					prevSlide();
				}
			}
		}, { passive: true });

		// Pause on hover (optional - can be annoying)
		// container.addEventListener('mouseenter', () => {
		// 	if (!isPaused) stopAutoplay();
		// });
		// container.addEventListener('mouseleave', () => {
		// 	if (!isPaused) startAutoplay();
		// });

		// Handle window resize
		const resizeHandler = () => {
			const newSlideWidth = slides[0].getBoundingClientRect().width;
			slides.forEach((slide, index) => {
				slide.style.left = newSlideWidth * index + 'px';
			});
			track.style.transform = `translateX(-${slides[currentIndex].style.left})`;
		};

		window.addEventListener('resize', resizeHandler);

		// Start autoplay
		startAutoplay();

		// Cleanup on navigation
		document.addEventListener('astro:before-swap', () => {
			stopAutoplay();
			window.removeEventListener('resize', resizeHandler);
		}, { once: true });
	}

	// Run on initial load and after every navigation
	document.addEventListener('astro:page-load', setupCarousel);
</script>
