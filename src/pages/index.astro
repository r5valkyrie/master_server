---
import Main from "../layouts/Main.astro";
---

<Main fullWidth={true}>
	<section class="hero">
		<div class="video-background">
			<video autoplay loop muted playsinline>
				<source src="/assets/shortshowcr5v.mp4" type="video/mp4" />
			</video>
			<div class="overlay"></div>
		</div>
		<div class="container hero-content fade-in">
			<div class="hero-badge delay-100">
				The Future of Apex Legends Modding
			</div>
			<h1 class="delay-200">
				Experience Apex <br /><span class="text-primary-gradient"
					>Like Never Before</span
				>
			</h1>
			<p class="hero-text delay-300">
				Valkyrie is the most advanced modding platform for Apex Legends.
				Host custom servers, create unique game modes, and join a
				thriving community.
			</p>
			<div class="hero-actions delay-300">
				<a href="/download" class="btn btn-primary">
					<svg
						xmlns="http://www.w3.org/2000/svg"
						width="20"
						height="20"
						viewBox="0 0 24 24"
						fill="none"
						stroke="currentColor"
						stroke-width="2"
						stroke-linecap="round"
						stroke-linejoin="round"
						><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"
						></path><polyline points="7 10 12 15 17 10"
						></polyline><line x1="12" y1="15" x2="12" y2="3"
						></line></svg
					>
					Download Now
				</a>
				<a href="#showcase" class="btn btn-glass"> Learn More </a>
			</div>
		</div>
	</section>

	<section id="showcase" class="showcase-section">
		<div class="container">
			<div class="section-header centered fade-in-on-scroll">
				<h2>Explore Valkyrie</h2>
				<p>Discover what makes our platform unique</p>
			</div>

			<div class="carousel-container fade-in-on-scroll">
				<div class="carousel-track-container">
					<ul class="carousel-track">
						<li class="carousel-slide current-slide">
							<div class="showcase-item">
								<div class="showcase-image">
									<img
										src="https://r5reloaded.com/assets/images/feature_1.jpg"
										alt="Custom Gamemodes"
										onerror="this.src='https://placehold.co/600x400?text=Custom+Gamemodes'"
									/>
								</div>
								<div class="showcase-text">
									<h3>Custom Gamemodes</h3>
									<p>
										Play unique gamemodes created by the
										community, from classic TDM and Gun Game
										to completely new experiences like Prop
										Hunt and Zombie Survival.
									</p>
								</div>
							</div>
						</li>
						<li class="carousel-slide">
							<div class="showcase-item">
								<div class="showcase-image">
									<img
										src="https://r5reloaded.com/assets/images/feature_2.jpg"
										alt="Modding Support"
										onerror="this.src='https://placehold.co/600x400?text=Modding+Support'"
									/>
								</div>
								<div class="showcase-text">
									<h3>Full Modding Support</h3>
									<p>
										Create your own scripts, weapons, and
										maps. Valkyrie exposes the full power of
										the engine, giving you the tools to
										build whatever you can imagine.
									</p>
								</div>
							</div>
						</li>
						<li class="carousel-slide">
							<div class="showcase-item">
								<div class="showcase-image">
									<img
										src="https://r5reloaded.com/assets/images/feature_3.jpg"
										alt="Dedicated Servers"
										onerror="this.src='https://placehold.co/600x400?text=Dedicated+Servers'"
									/>
								</div>
								<div class="showcase-text">
									<h3>Dedicated Servers</h3>
									<p>
										Host your own dedicated servers with
										custom rules, map rotations, and high
										tickrates for the smoothest gameplay
										experience.
									</p>
								</div>
							</div>
						</li>
					</ul>
				</div>

				<button class="carousel-button carousel-button--left is-hidden">
					<svg
						xmlns="http://www.w3.org/2000/svg"
						width="24"
						height="24"
						viewBox="0 0 24 24"
						fill="none"
						stroke="currentColor"
						stroke-width="2"
						stroke-linecap="round"
						stroke-linejoin="round"
						><polyline points="15 18 9 12 15 6"></polyline></svg
					>
				</button>
				<button class="carousel-button carousel-button--right">
					<svg
						xmlns="http://www.w3.org/2000/svg"
						width="24"
						height="24"
						viewBox="0 0 24 24"
						fill="none"
						stroke="currentColor"
						stroke-width="2"
						stroke-linecap="round"
						stroke-linejoin="round"
						><polyline points="9 18 15 12 9 6"></polyline></svg
					>
				</button>

				<div class="carousel-nav">
					<button class="carousel-indicator current-slide"></button>
					<button class="carousel-indicator"></button>
					<button class="carousel-indicator"></button>
				</div>
			</div>
		</div>
	</section>

	<section class="features">
		<div class="container">
			<div class="grid-3">
				<div class="feature-card fade-in-on-scroll">
					<div class="icon-box">
						<svg
							xmlns="http://www.w3.org/2000/svg"
							width="24"
							height="24"
							viewBox="0 0 24 24"
							fill="none"
							stroke="currentColor"
							stroke-width="2"
							stroke-linecap="round"
							stroke-linejoin="round"
							><rect
								x="2"
								y="3"
								width="20"
								height="14"
								rx="2"
								ry="2"></rect><line
								x1="8"
								y1="21"
								x2="16"
								y2="21"></line><line
								x1="12"
								y1="17"
								x2="12"
								y2="21"></line></svg
						>
					</div>
					<h3>Server Browser</h3>
					<p>
						Easily find and join community servers with our advanced
						server browser.
					</p>
				</div>
				<div class="feature-card fade-in-on-scroll">
					<div class="icon-box">
						<svg
							xmlns="http://www.w3.org/2000/svg"
							width="24"
							height="24"
							viewBox="0 0 24 24"
							fill="none"
							stroke="currentColor"
							stroke-width="2"
							stroke-linecap="round"
							stroke-linejoin="round"
							><polygon points="12 2 2 7 12 12 22 7 12 2"
							></polygon><polyline points="2 17 12 22 22 17"
							></polyline><polyline points="2 12 12 17 22 12"
							></polyline></svg
						>
					</div>
					<h3>Mod Manager</h3>
					<p>
						Install and manage mods with a single click using our
						integrated mod manager.
					</p>
				</div>
				<div class="feature-card fade-in-on-scroll">
					<div class="icon-box">
						<svg
							xmlns="http://www.w3.org/2000/svg"
							width="24"
							height="24"
							viewBox="0 0 24 24"
							fill="none"
							stroke="currentColor"
							stroke-width="2"
							stroke-linecap="round"
							stroke-linejoin="round"
							><path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"
							></path><circle cx="9" cy="7" r="4"></circle><path
								d="M23 21v-2a4 4 0 0 0-3-3.87"></path><path
								d="M16 3.13a4 4 0 0 1 0 7.75"></path></svg
						>
					</div>
					<h3>Open Source</h3>
					<p>
						Valkyrie is open source and community driven. Join us on
						GitHub!
					</p>
				</div>
			</div>
		</div>
	</section>

	<section class="cta-section">
		<div class="container">
			<div class="cta-box fade-in-on-scroll">
				<h2>Ready to jump in?</h2>
				<p>Join thousands of players on Valkyrie today.</p>
				<a
					href="https://discord.gg/GcJSMUGJyD"
					target="_blank"
					class="btn btn-primary">Join Discord</a
				>
			</div>
		</div>
	</section>
</Main>

<style>
	.hero {
		min-height: 100vh;
		display: flex;
		align-items: center;
		justify-content: center;
		text-align: center;
		padding: 60px 20px;
		position: relative;
		overflow: hidden;
	}

	.video-background {
		position: absolute;
		top: 0;
		left: 0;
		width: 100%;
		height: 100%;
		z-index: -1;
	}

	.video-background video {
		width: 100%;
		height: 100%;
		object-fit: cover;
	}

	.video-background .overlay {
		position: absolute;
		top: 0;
		left: 0;
		width: 100%;
		height: 100%;
		background: rgba(5, 5, 5, 0.7); /* Dark overlay */
		backdrop-filter: blur(3px);
	}

	.hero-content {
		display: flex;
		flex-direction: column;
		align-items: center;
		gap: 24px;
		position: relative;
		z-index: 1;
	}

	.hero-badge {
		background: rgba(99, 102, 241, 0.1);
		color: var(--primary);
		padding: 6px 16px;
		border-radius: var(--radius-full);
		font-size: 0.9rem;
		font-weight: 600;
		border: 1px solid rgba(99, 102, 241, 0.2);
		backdrop-filter: blur(10px);
	}

	.hero-text {
		font-size: 1.25rem;
		color: var(--text-muted);
		max-width: 600px;
		line-height: 1.6;
	}

	.hero-actions {
		display: flex;
		gap: 16px;
		margin-top: 10px;
	}

	/* Showcase Section */
	.showcase-section {
		padding: 100px 0;
		background: linear-gradient(to bottom, var(--bg-dark), #0a0a0c);
		overflow: hidden;
	}

	.section-header.centered {
		text-align: center;
		margin-bottom: 60px;
	}

	.section-header h2 {
		font-size: 2.5rem;
		margin-bottom: 10px;
	}

	.section-header p {
		color: var(--text-muted);
		font-size: 1.2rem;
	}

	/* Carousel */
	.carousel-container {
		position: relative;
		height: 500px;
		width: 100%;
		max-width: 1000px;
		margin: 0 auto;
	}

	.carousel-track-container {
		height: 100%;
		position: relative;
		overflow: hidden;
		border-radius: var(--radius-lg);
		box-shadow: var(--shadow-glow);
		background: var(--bg-card);
		border: 1px solid var(--border-light);
	}

	.carousel-track {
		padding: 0;
		margin: 0;
		list-style: none;
		position: relative;
		height: 100%;
		transition: transform 0.5s ease-in-out;
	}

	.carousel-slide {
		position: absolute;
		top: 0;
		bottom: 0;
		width: 100%;
		display: flex;
		align-items: center;
		justify-content: center;
	}

	.showcase-item {
		display: grid;
		grid-template-columns: 1fr 1fr;
		gap: 40px;
		align-items: center;
		padding: 40px;
		width: 100%;
		height: 100%;
	}

	.showcase-image {
		position: relative;
		border-radius: var(--radius-md);
		overflow: hidden;
		height: 100%;
		max-height: 400px;
		box-shadow: var(--shadow-sm);
	}

	.showcase-image img {
		width: 100%;
		height: 100%;
		object-fit: cover;
		display: block;
	}

	.showcase-text {
		padding-right: 20px;
	}

	.showcase-text h3 {
		font-size: 2rem;
		margin-bottom: 20px;
		color: var(--text-main);
	}

	.showcase-text p {
		font-size: 1.1rem;
		color: var(--text-muted);
		line-height: 1.7;
	}

	/* Carousel Controls */
	.carousel-button {
		position: absolute;
		top: 50%;
		transform: translateY(-50%);
		background: rgba(0, 0, 0, 0.5);
		border: 1px solid var(--border-light);
		color: var(--text-main);
		width: 48px;
		height: 48px;
		border-radius: 50%;
		cursor: pointer;
		z-index: 10;
		display: flex;
		align-items: center;
		justify-content: center;
		transition: all 0.3s ease;
		backdrop-filter: blur(5px);
	}

	.carousel-button:hover {
		background: var(--primary);
		border-color: var(--primary);
		transform: translateY(-50%) scale(1.1);
	}

	.carousel-button--left {
		left: -24px;
	}

	.carousel-button--right {
		right: -24px;
	}

	.carousel-button.is-hidden {
		display: none;
	}

	.carousel-nav {
		display: flex;
		justify-content: center;
		padding: 20px 0;
		gap: 12px;
	}

	.carousel-indicator {
		border: 0;
		border-radius: 50%;
		width: 12px;
		height: 12px;
		background: rgba(255, 255, 255, 0.2);
		cursor: pointer;
		transition: all 0.3s ease;
	}

	.carousel-indicator.current-slide {
		background: var(--primary);
		transform: scale(1.2);
	}

	.carousel-indicator:hover {
		background: rgba(255, 255, 255, 0.5);
	}

	@media (max-width: 768px) {
		.carousel-container {
			height: auto;
			max-width: 100%;
		}

		.carousel-track-container {
			height: auto;
		}

		.carousel-track {
			height: auto;
			position: relative; /* Change from absolute positioning logic if needed, but for simple slide we keep it */
		}

		.carousel-slide {
			position: relative; /* Stack them or keep absolute? For simple carousel, absolute is easier */
			width: 100%;
		}

		.showcase-item {
			grid-template-columns: 1fr;
			gap: 20px;
			padding: 20px;
			text-align: center;
		}

		.showcase-text {
			padding-right: 0;
		}

		.showcase-image {
			max-height: 250px;
		}

		.carousel-button--left {
			left: 10px;
		}

		.carousel-button--right {
			right: 10px;
		}
	}

	.features {
		padding: 100px 0;
	}

	.grid-3 {
		display: grid;
		grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
		gap: 30px;
	}

	.feature-card {
		background: var(--bg-card);
		border: 1px solid var(--border-light);
		padding: 40px 30px;
		border-radius: var(--radius-lg);
		transition: all 0.3s ease;
	}

	.feature-card:hover {
		transform: translateY(-5px);
		background: var(--bg-card-hover);
		border-color: var(--border-hover);
	}

	.icon-box {
		width: 50px;
		height: 50px;
		background: rgba(255, 255, 255, 0.05);
		border-radius: 12px;
		display: flex;
		align-items: center;
		justify-content: center;
		margin-bottom: 20px;
		color: var(--primary);
	}

	.feature-card h3 {
		margin-bottom: 10px;
		font-size: 1.5rem;
	}

	.feature-card p {
		color: var(--text-muted);
	}

	.cta-section {
		padding: 60px 0 100px;
	}

	.cta-box {
		background: linear-gradient(
			135deg,
			rgba(99, 102, 241, 0.1) 0%,
			rgba(236, 72, 153, 0.1) 100%
		);
		border: 1px solid var(--border-light);
		border-radius: var(--radius-lg);
		padding: 60px;
		text-align: center;
		display: flex;
		flex-direction: column;
		align-items: center;
		gap: 20px;
	}

	.cta-box h2 {
		font-size: 2.5rem;
	}

	.cta-box p {
		font-size: 1.2rem;
		color: var(--text-muted);
		margin-bottom: 10px;
	}

	@media (max-width: 768px) {
		.hero-actions {
			flex-direction: column;
			width: 100%;
		}

		.btn {
			width: 100%;
		}

		.showcase-item {
			grid-template-columns: 1fr;
			gap: 30px;
		}

		.showcase-item.reverse {
			direction: ltr;
		background: rgba(0, 0, 0, 0.5);
		border: 1px solid var(--border-light);
		color: var(--text-main);
		width: 48px;
		height: 48px;
		border-radius: 50%;
		cursor: pointer;
		z-index: 10;
		display: flex;
		align-items: center;
		justify-content: center;
		transition: all 0.3s ease;
		backdrop-filter: blur(5px);
	}

	.carousel-button:hover {
		background: var(--primary);
		border-color: var(--primary);
		transform: translateY(-50%) scale(1.1);
	}

	.carousel-button--left {
		left: -24px;
	}

	.carousel-button--right {
		right: -24px;
	}

	.carousel-button.is-hidden {
		display: none;
	}

	.carousel-nav {
		display: flex;
		justify-content: center;
		padding: 20px 0;
		gap: 12px;
	}

	.carousel-indicator {
		border: 0;
		border-radius: 50%;
		width: 12px;
		height: 12px;
		background: rgba(255, 255, 255, 0.2);
		cursor: pointer;
		transition: all 0.3s ease;
	}

	.carousel-indicator.current-slide {
		background: var(--primary);
		transform: scale(1.2);
	}

	.carousel-indicator:hover {
		background: rgba(255, 255, 255, 0.5);
	}

	@media (max-width: 768px) {
		.carousel-container {
			height: auto;
			max-width: 100%;
		}

		.carousel-track-container {
			height: auto;
		}

		.carousel-track {
			height: auto;
			position: relative; /* Change from absolute positioning logic if needed, but for simple slide we keep it */
		}

		.carousel-slide {
			position: relative; /* Stack them or keep absolute? For simple carousel, absolute is easier */
			width: 100%;
		}

		.showcase-item {
			grid-template-columns: 1fr;
			gap: 20px;
			padding: 20px;
			text-align: center;
		}

		.showcase-text {
			padding-right: 0;
		}

		.showcase-image {
			max-height: 250px;
		}

		.carousel-button--left {
			left: 10px;
		}

		.carousel-button--right {
			right: 10px;
		}
	}

	.features {
		padding: 100px 0;
	}

	.grid-3 {
		display: grid;
		grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
		gap: 30px;
	}

	.feature-card {
		background: var(--bg-card);
		border: 1px solid var(--border-light);
		padding: 40px 30px;
		border-radius: var(--radius-lg);
		transition: all 0.3s ease;
	}

	.feature-card:hover {
		transform: translateY(-5px);
		background: var(--bg-card-hover);
		border-color: var(--border-hover);
	}

	.icon-box {
		width: 50px;
		height: 50px;
		background: rgba(255, 255, 255, 0.05);
		border-radius: 12px;
		display: flex;
		align-items: center;
		justify-content: center;
		margin-bottom: 20px;
		color: var(--primary);
	}

	.feature-card h3 {
		margin-bottom: 10px;
		font-size: 1.5rem;
	}

	.feature-card p {
		color: var(--text-muted);
	}

	.cta-section {
		padding: 60px 0 100px;
	}

	.cta-box {
		background: linear-gradient(
			135deg,
			rgba(99, 102, 241, 0.1) 0%,
			rgba(236, 72, 153, 0.1) 100%
		);
		border: 1px solid var(--border-light);
		border-radius: var(--radius-lg);
		padding: 60px;
		text-align: center;
		display: flex;
		flex-direction: column;
		align-items: center;
		gap: 20px;
	}

	.cta-box h2 {
		font-size: 2.5rem;
	}

	.cta-box p {
		font-size: 1.2rem;
		color: var(--text-muted);
		margin-bottom: 10px;
	}

	@media (max-width: 768px) {
		.hero-actions {
			flex-direction: column;
			width: 100%;
		}

		.btn {
			width: 100%;
		}

		.showcase-item {
			grid-template-columns: 1fr;
			gap: 30px;
		}

		.showcase-item.reverse {
			direction: ltr;
		}
	}
</style>

<script>
	document.addEventListener('astro:page-load', () => {
		const track = document.querySelector('.carousel-track') as HTMLElement | null;
		if (!track) return;

		const slides = Array.from(track.children) as HTMLElement[];
		const nextButton = document.querySelector('.carousel-button--right');
		const prevButton = document.querySelector('.carousel-button--left');
		const dotsNav = document.querySelector('.carousel-nav');
		
		if (!nextButton || !prevButton || !dotsNav) return;

		const dots = Array.from(dotsNav.children) as HTMLElement[];

		if (slides.length === 0) return;

		const slideWidth = slides[0].getBoundingClientRect().width;

		// Arrange the slides next to one another
		const setSlidePosition = (slide: HTMLElement, index: number) => {
			slide.style.left = slideWidth * index + 'px';
		};
		slides.forEach(setSlidePosition);

		const moveToSlide = (track: HTMLElement, currentSlide: HTMLElement, targetSlide: HTMLElement) => {
			track.style.transform = 'translateX(-' + targetSlide.style.left + ')';
			currentSlide.classList.remove('current-slide');
			targetSlide.classList.add('current-slide');
		};

		const updateDots = (currentDot: Element, targetDot: Element) => {
			currentDot.classList.remove('current-slide');
			targetDot.classList.add('current-slide');
		};

		const hideShowArrows = (slides: HTMLElement[], prevButton: Element, nextButton: Element, targetIndex: number) => {
			if (targetIndex === 0) {
				prevButton.classList.add('is-hidden');
				nextButton.classList.remove('is-hidden');
			} else if (targetIndex === slides.length - 1) {
				prevButton.classList.remove('is-hidden');
				nextButton.classList.add('is-hidden');
			} else {
				prevButton.classList.remove('is-hidden');
				nextButton.classList.remove('is-hidden');
			}
		};

		// Next button click
		nextButton.addEventListener('click', e => {
			const currentSlide = track.querySelector('.current-slide') as HTMLElement;
			const nextSlide = currentSlide.nextElementSibling as HTMLElement;
			const currentDot = dotsNav.querySelector('.current-slide');
			const nextDot = currentDot?.nextElementSibling;
			
			if (!nextSlide || !currentDot || !nextDot) return;

			const nextIndex = slides.findIndex(slide => slide === nextSlide);

			moveToSlide(track, currentSlide, nextSlide);
			updateDots(currentDot, nextDot);
			hideShowArrows(slides, prevButton, nextButton, nextIndex);
		});

		// Prev button click
		prevButton.addEventListener('click', e => {
			const currentSlide = track.querySelector('.current-slide') as HTMLElement;
			const prevSlide = currentSlide.previousElementSibling as HTMLElement;
			const currentDot = dotsNav.querySelector('.current-slide');
			const prevDot = currentDot?.previousElementSibling;
			
			if (!prevSlide || !currentDot || !prevDot) return;

			const prevIndex = slides.findIndex(slide => slide === prevSlide);

			moveToSlide(track, currentSlide, prevSlide);
			updateDots(currentDot, prevDot);
			hideShowArrows(slides, prevButton, nextButton, prevIndex);
		});

		// Dot click
		dotsNav.addEventListener('click', e => {
			const targetDot = (e.target as HTMLElement).closest('button');

			if (!targetDot) return;

			const currentSlide = track.querySelector('.current-slide') as HTMLElement;
			const currentDot = dotsNav.querySelector('.current-slide');
			
			if (!currentSlide || !currentDot) return;

			const targetIndex = dots.findIndex(dot => dot === targetDot);
			const targetSlide = slides[targetIndex];

			moveToSlide(track, currentSlide, targetSlide);
			updateDots(currentDot, targetDot);
			hideShowArrows(slides, prevButton, nextButton, targetIndex);
		});

		// Handle resize
		window.addEventListener('resize', () => {
			const newSlideWidth = slides[0].getBoundingClientRect().width;
			slides.forEach((slide, index) => {
				slide.style.left = newSlideWidth * index + 'px';
			});
			// Re-center current slide
			const currentSlide = track.querySelector('.current-slide') as HTMLElement;
			if (currentSlide) {
				track.style.transform = 'translateX(-' + currentSlide.style.left + ')';
			}
		});
	});
</script>
