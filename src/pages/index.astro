---
import Main from "../layouts/Main.astro";
---

<Main title="Home" fullWidth={true}>
	<section class="hero">
		<div class="hero-content fade-in">
			<h1>
				The Future of <span class="text-gradient">Apex Legends</span>
			</h1>
			<p class="hero-text">
				Experience the game like never before with custom servers,
				modding support, and a thriving community.
			</p>
			<div class="hero-actions">
				<a href="/download" class="btn btn-primary">Download Now</a>
				<a href="/docs" class="btn btn-secondary">Documentation</a>
			</div>
		</div>
	</section>

	<section class="showcase-section">
		<div class="container">
			<div class="section-header centered fade-in-on-scroll">
				<h2>Experience the Difference</h2>
				<p>See what makes R5Valkyrie unique.</p>
			</div>

			<div class="carousel-container fade-in-on-scroll">
				<div class="carousel-track-container">
					<ul class="carousel-track">
						<li class="carousel-slide current-slide">
							<div class="showcase-item">
								<div class="showcase-image">
									<img
										src="/assets/showcase1.png"
										alt="Custom Gamemodes"
									/>
								</div>
								<div class="showcase-text">
									<h3>Custom Gamemodes</h3>
									<p>
										Play unique gamemodes created by the
										community, or build your own with Apex
										Legends powerful scripting language.
										From TDM to Prop Hunt, the possibilities
										are endless.
									</p>
								</div>
							</div>
						</li>
						<li class="carousel-slide">
							<div class="showcase-item">
								<div class="showcase-image">
									<img
										src="/assets/showcase2.png"
										alt="Modding Support"
									/>
								</div>
								<div class="showcase-text">
									<h3>Full Modding Support</h3>
									<p>
										Customize every aspect of the game.
										Import custom assets, create new maps,
										and tweak weapon stats to your liking.
									</p>
								</div>
							</div>
						</li>
						<li class="carousel-slide">
							<div class="showcase-item">
								<div class="showcase-image">
									<img
										src="/assets/showcase3.png"
										alt="Community Servers"
									/>
								</div>
								<div class="showcase-text">
									<h3>Community Servers</h3>
									<p>
										Host your own dedicated servers with
										full control over settings, bans, and
										permissions. Join a community that fits
										your playstyle.
									</p>
								</div>
							</div>
						</li>
					</ul>
				</div>

				<button class="carousel-button carousel-button--left is-hidden">
					<svg
						xmlns="http://www.w3.org/2000/svg"
						width="24"
						height="24"
						viewBox="0 0 24 24"
						fill="none"
						stroke="currentColor"
						stroke-width="2"
						stroke-linecap="round"
						stroke-linejoin="round"
						><polyline points="15 18 9 12 15 6"></polyline></svg
					>
				</button>

				<button class="carousel-button carousel-button--right">
					<svg
						xmlns="http://www.w3.org/2000/svg"
						width="24"
						height="24"
						viewBox="0 0 24 24"
						fill="none"
						stroke="currentColor"
						stroke-width="2"
						stroke-linecap="round"
						stroke-linejoin="round"
						><polyline points="9 18 15 12 9 6"></polyline></svg
					>
				</button>

				<div class="carousel-nav">
					<button class="carousel-indicator current-slide"></button>
					<button class="carousel-indicator"></button>
					<button class="carousel-indicator"></button>
				</div>
			</div>
		</div>
	</section>

	<section class="features">
		<div class="container">
			<div class="grid-3">
				<div class="feature-card fade-in-on-scroll">
					<div class="icon-box">
						<svg
							xmlns="http://www.w3.org/2000/svg"
							width="24"
							height="24"
							viewBox="0 0 24 24"
							fill="none"
							stroke="currentColor"
							stroke-width="2"
							stroke-linecap="round"
							stroke-linejoin="round"
							><rect
								x="2"
								y="3"
								width="20"
								height="14"
								rx="2"
								ry="2"></rect><line
								x1="8"
								y1="21"
								x2="16"
								y2="21"></line><line
								x1="12"
								y1="17"
								x2="12"
								y2="21"></line></svg
						>
					</div>
					<h3>Server Browser</h3>
					<p>
						Easily find and join community servers with our advanced
						server browser.
					</p>
				</div>
				<div class="feature-card fade-in-on-scroll">
					<div class="icon-box">
						<svg
							xmlns="http://www.w3.org/2000/svg"
							width="24"
							height="24"
							viewBox="0 0 24 24"
							fill="none"
							stroke="currentColor"
							stroke-width="2"
							stroke-linecap="round"
							stroke-linejoin="round"
							><polygon points="12 2 2 7 12 12 22 7 12 2"
							></polygon><polyline points="2 17 12 22 22 17"
							></polyline><polyline points="2 12 12 17 22 12"
							></polyline></svg
						>
					</div>
					<h3>Mod Manager</h3>
					<p>
						Install and manage mods with a single click using our
						integrated mod manager.
					</p>
				</div>
				<div class="feature-card fade-in-on-scroll">
					<div class="icon-box">
						<svg
							xmlns="http://www.w3.org/2000/svg"
							width="24"
							height="24"
							viewBox="0 0 24 24"
							fill="none"
							stroke="currentColor"
							stroke-width="2"
							stroke-linecap="round"
							stroke-linejoin="round"
							><path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"
							></path><circle cx="9" cy="7" r="4"></circle><path
								d="M23 21v-2a4 4 0 0 0-3-3.87"></path><path
								d="M16 3.13a4 4 0 0 1 0 7.75"></path></svg
						>
					</div>
					<h3>Open Source</h3>
					<p>
						R5Valkyrie is open source and community driven. Join us
						on GitHub!
					</p>
				</div>
			</div>
		</div>
	</section>

	<section class="cta-section">
		<div class="container">
			<div class="cta-box fade-in-on-scroll">
				<h2>Ready to jump in?</h2>
				<p>Join us on R5Valkyrie today.</p>
				<a
					href="https://discord.gg/GcJSMUGJyD"
					target="_blank"
					class="btn btn-primary">Join Discord</a
				>
			</div>
		</div>
	</section>
</Main>

<style>
	.hero {
		min-height: 100vh;
		display: flex;
		align-items: center;
		justify-content: center;
		text-align: center;
		padding: 60px 20px;
		position: relative;
		overflow: hidden;
	}

	.hero-content {
		display: flex;
		flex-direction: column;
		align-items: center;
		gap: 24px;
		position: relative;
		z-index: 1;
	}

	.hero-badge {
		background: rgba(99, 102, 241, 0.1);
		color: var(--primary);
		padding: 6px 16px;
		border-radius: var(--radius-full);
		font-size: 0.9rem;
		font-weight: 600;
		border: 1px solid rgba(99, 102, 241, 0.2);
		backdrop-filter: blur(10px);
	}

	.hero-text {
		font-size: 1.25rem;
		color: var(--text-muted);
		max-width: 600px;
		line-height: 1.6;
	}

	.hero-actions {
		display: flex;
		gap: 16px;
		margin-top: 10px;
	}

	/* Showcase Section */
	.showcase-section {
		padding: 100px 0;
		background: linear-gradient(to bottom, var(--bg-dark), #0a0a0c);
		overflow: hidden;
	}

	.section-header.centered {
		text-align: center;
		margin-bottom: 60px;
	}

	.section-header h2 {
		font-size: 2.5rem;
		margin-bottom: 10px;
	}

	.section-header p {
		color: var(--text-muted);
		font-size: 1.2rem;
	}

	/* Carousel Styles - Redesigned */
	.carousel-container {
		position: relative;
		height: 600px;
		width: 100%;
		max-width: 1400px;
		margin: 0 auto;
		overflow: hidden;
		border-radius: var(--radius-lg);
		box-shadow: 0 20px 50px rgba(0, 0, 0, 0.5); /* Neutral dark shadow */
	}

	.carousel-track-container {
		height: 100%;
		position: relative;
		overflow: hidden;
	}

	.carousel-track {
		padding: 0;
		margin: 0;
		list-style: none;
		position: relative;
		height: 100%;
		transition: transform 0.5s cubic-bezier(0.25, 1, 0.5, 1);
	}

	.carousel-slide {
		position: absolute;
		top: 0;
		bottom: 0;
		width: 100%;
		height: 100%;
	}

	.showcase-item {
		position: relative;
		width: 100%;
		height: 100%;
		display: flex;
		overflow: hidden;
	}

	/* Image as Background */
	.showcase-image {
		position: absolute;
		inset: 0;
		z-index: 1;
		width: 100%;
		height: 100%;
	}

	.showcase-image img {
		width: 100%;
		height: 100%;
		object-fit: cover;
		transition: transform 0.5s ease;
	}

	.carousel-container:hover .showcase-image img {
		transform: scale(1.02);
	}

	/* Text as Glass Overlay */
	.showcase-text {
		position: absolute;
		bottom: 40px;
		left: 40px;
		z-index: 2;
		max-width: 550px;
		background: rgba(5, 5, 5, 0.75);
		backdrop-filter: blur(16px);
		padding: 40px;
		border-radius: 24px;
		border: 1px solid rgba(255, 255, 255, 0.1);
		box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
		transform: translateY(0);
		opacity: 1;
		transition: all 0.5s ease 0.2s;
	}

	.showcase-text h3 {
		font-size: 2.5rem;
		margin-bottom: 16px;
		background: linear-gradient(to right, #fff, #ccc);
		-webkit-background-clip: text;
		-webkit-text-fill-color: transparent;
		line-height: 1.1;
	}

	.showcase-text p {
		font-size: 1.1rem;
		line-height: 1.6;
		margin-bottom: 24px;
		color: rgba(255, 255, 255, 0.9);
	}

	/* Buttons - Larger and Floating */
	.carousel-button {
		position: absolute;
		top: 50%;
		transform: translateY(-50%);
		background: rgba(255, 255, 255, 0.1);
		border: 1px solid rgba(255, 255, 255, 0.2);
		color: white;
		width: 56px;
		height: 56px;
		border-radius: 50%;
		cursor: pointer;
		z-index: 10;
		display: flex;
		align-items: center;
		justify-content: center;
		transition: all 0.3s ease;
		backdrop-filter: blur(8px);
	}

	.carousel-button:hover {
		background: white; /* Neutral hover */
		color: black;
		border-color: white;
		box-shadow: 0 0 20px rgba(255, 255, 255, 0.3); /* White glow */
		transform: translateY(-50%) scale(1.1);
	}

	.carousel-button--left {
		left: 24px;
	}

	.carousel-button--right {
		right: 24px;
	}

	.carousel-button.is-hidden {
		opacity: 0;
		pointer-events: none;
	}

	/* Indicators - Bars instead of dots */
	.carousel-nav {
		position: absolute;
		bottom: 30px;
		right: 40px;
		z-index: 10;
		display: flex;
		gap: 8px;
		padding: 0;
	}

	.carousel-indicator {
		border: 0;
		border-radius: 4px;
		width: 30px;
		height: 4px;
		background: rgba(255, 255, 255, 0.3);
		cursor: pointer;
		transition: all 0.3s ease;
	}

	.carousel-indicator.current-slide {
		background: white; /* Neutral active state */
		width: 45px;
		box-shadow: 0 0 10px rgba(255, 255, 255, 0.5); /* White glow */
	}

	.carousel-indicator:hover {
		background: rgba(255, 255, 255, 0.8);
	}

	@media (max-width: 768px) {
		.carousel-container {
			height: 500px;
			border-radius: 0; /* Full width on mobile often looks better without radius */
		}

		.showcase-text {
			bottom: 0;
			left: 0;
			width: 100%;
			max-width: 100%;
			border-radius: 0;
			border-top: 1px solid rgba(255, 255, 255, 0.1);
			background: rgba(5, 5, 5, 0.85);
			padding: 24px;
		}

		.showcase-text h3 {
			font-size: 1.8rem;
		}

		.carousel-nav {
			bottom: 200px; /* Move up above text */
			right: 50%;
			transform: translateX(50%);
		}

		.carousel-button {
			width: 40px;
			height: 40px;
		}
	}

	.features {
		padding: 100px 0;
	}

	.grid-3 {
		display: grid;
		grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
		gap: 30px;
	}

	.feature-card {
		background: var(--bg-card);
		border: 1px solid var(--border-light);
		padding: 40px 30px;
		border-radius: var(--radius-lg);
		transition: all 0.3s ease;
	}

	.feature-card:hover {
		transform: translateY(-5px);
		background: var(--bg-card-hover);
		border-color: var(--border-hover);
	}

	.icon-box {
		width: 50px;
		height: 50px;
		background: rgba(255, 255, 255, 0.05);
		border-radius: 12px;
		display: flex;
		align-items: center;
		justify-content: center;
		margin-bottom: 20px;
		color: var(--primary);
	}

	.feature-card h3 {
		margin-bottom: 10px;
		font-size: 1.5rem;
	}

	.feature-card p {
		color: var(--text-muted);
	}

	.cta-section {
		padding: 60px 0 100px;
	}

	.cta-box {
		background: linear-gradient(
			135deg,
			rgba(99, 102, 241, 0.1) 0%,
			rgba(236, 72, 153, 0.1) 100%
		);
		border: 1px solid var(--border-light);
		border-radius: var(--radius-lg);
		padding: 60px;
		text-align: center;
		display: flex;
		flex-direction: column;
		align-items: center;
		gap: 20px;
	}

	.cta-box h2 {
		font-size: 2.5rem;
	}

	.cta-box p {
		font-size: 1.2rem;
		color: var(--text-muted);
		margin-bottom: 10px;
	}

	@media (max-width: 768px) {
		.hero-actions {
			flex-direction: column;
			width: 100%;
		}

		.btn {
			width: 100%;
		}
	}
</style>

<script>
	function setupCarousel() {
		const track = document.querySelector(
			".carousel-track",
		) as HTMLElement | null;
		if (!track) return;

		const slides = Array.from(track.children) as HTMLElement[];
		const nextButton = document.querySelector(
			".carousel-button--right",
		) as HTMLElement | null;
		const prevButton = document.querySelector(
			".carousel-button--left",
		) as HTMLElement | null;
		const dotsNav = document.querySelector(
			".carousel-nav",
		) as HTMLElement | null;
		const dots = Array.from(dotsNav?.children || []) as HTMLElement[];

		if (slides.length > 0) {
			const slideWidth = slides[0].getBoundingClientRect().width;

			// Arrange the slides next to one another
			const setSlidePosition = (slide: HTMLElement, index: number) => {
				slide.style.left = slideWidth * index + "px";
			};
			slides.forEach(setSlidePosition);

			const moveToSlide = (
				track: HTMLElement,
				currentSlide: HTMLElement,
				targetSlide: HTMLElement,
			) => {
				track.style.transform =
					"translateX(-" + targetSlide.style.left + ")";
				currentSlide.classList.remove("current-slide");
				targetSlide.classList.add("current-slide");
			};

			const updateDots = (
				currentDot: HTMLElement,
				targetDot: HTMLElement,
			) => {
				currentDot.classList.remove("current-slide");
				targetDot.classList.add("current-slide");
			};

			const hideShowArrows = (
				slides: HTMLElement[],
				prevButton: HTMLElement,
				nextButton: HTMLElement,
				targetIndex: number,
			) => {
				if (targetIndex === 0) {
					prevButton.classList.add("is-hidden");
					nextButton.classList.remove("is-hidden");
				} else if (targetIndex === slides.length - 1) {
					prevButton.classList.remove("is-hidden");
					nextButton.classList.add("is-hidden");
				} else {
					prevButton.classList.remove("is-hidden");
					nextButton.classList.remove("is-hidden");
				}
			};

			// When I click left, move slides to the left
			if (prevButton) {
				prevButton.addEventListener("click", (e) => {
					const currentSlide = track.querySelector(
						".current-slide",
					) as HTMLElement;
					const prevSlide =
						currentSlide.previousElementSibling as HTMLElement;
					const currentDot = dotsNav?.querySelector(
						".current-slide",
					) as HTMLElement;
					const prevDot =
						currentDot.previousElementSibling as HTMLElement;
					const prevIndex = slides.findIndex(
						(slide) => slide === prevSlide,
					);

					moveToSlide(track, currentSlide, prevSlide);
					updateDots(currentDot, prevDot);
					if (nextButton)
						hideShowArrows(
							slides,
							prevButton,
							nextButton,
							prevIndex,
						);
				});
			}

			// When I click right, move slides to the right
			if (nextButton) {
				nextButton.addEventListener("click", (e) => {
					const currentSlide = track.querySelector(
						".current-slide",
					) as HTMLElement;
					const nextSlide =
						currentSlide.nextElementSibling as HTMLElement;
					const currentDot = dotsNav?.querySelector(
						".current-slide",
					) as HTMLElement;
					const nextDot =
						currentDot.nextElementSibling as HTMLElement;
					const nextIndex = slides.findIndex(
						(slide) => slide === nextSlide,
					);

					moveToSlide(track, currentSlide, nextSlide);
					updateDots(currentDot, nextDot);
					if (prevButton)
						hideShowArrows(
							slides,
							prevButton,
							nextButton,
							nextIndex,
						);
				});
			}

			// When I click the nav indicators, move to that slide
			if (dotsNav) {
				dotsNav.addEventListener("click", (e) => {
					// what indicator was clicked on?
					const targetDot = (e.target as HTMLElement).closest(
						"button",
					);

					if (!targetDot) return;

					const currentSlide = track.querySelector(
						".current-slide",
					) as HTMLElement;
					const currentDot = dotsNav.querySelector(
						".current-slide",
					) as HTMLElement;
					const targetIndex = dots.findIndex(
						(dot) => dot === targetDot,
					);
					const targetSlide = slides[targetIndex];

					moveToSlide(track, currentSlide, targetSlide);
					updateDots(currentDot, targetDot);
					if (prevButton && nextButton)
						hideShowArrows(
							slides,
							prevButton,
							nextButton,
							targetIndex,
						);
				});
			}

			// Handle window resize to adjust slide positions
			const resizeHandler = () => {
				const newSlideWidth = slides[0].getBoundingClientRect().width;
				slides.forEach((slide, index) => {
					slide.style.left = newSlideWidth * index + "px";
				});
				// Re-center current slide
				const currentSlide = track.querySelector(
					".current-slide",
				) as HTMLElement;
				track.style.transform =
					"translateX(-" + currentSlide.style.left + ")";
			};

			window.addEventListener("resize", resizeHandler);

			// Cleanup resize listener on navigation
			document.addEventListener(
				"astro:before-swap",
				() => {
					window.removeEventListener("resize", resizeHandler);
				},
				{ once: true },
			);
		}
	}

	// Run on initial load and after every navigation
	document.addEventListener("astro:page-load", setupCarousel);
</script>
